@page
@model QLThuVienMVC.Pages.NhanVien.XacNhanTraSachModel
@{
    ViewData["Title"] = "Xác nhận trả sách";
}
<div class="container mt-5">
    <h1 class="text-primary text-center display-6 mb-4">📕 Xác nhận trả sách</h1>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger">@TempData["Error"]</div>
    }

    <div class="mb-4">
        <a asp-controller="Home" asp-action="Index" class="btn btn-secondary">
            ⬅ Quay lại trang chủ
        </a>
    </div>

    <form method="post" asp-page-handler="TimDG" class="mb-4">
        <div class="form-group d-flex gap-2">
            <input type="text" class="form-control w-50" id="MaDocGia" name="MaDocGia" placeholder="🔍 Nhập mã độc giả..." / required>
            <button type="submit" class="btn btn-primary">Tìm kiếm</button>
        </div>
    </form>

    @if (Model.dsct != null && Model.dsct.Count > 0)
    {
   
            <h4 class="text-success fw-bold">📚 Danh sách sách cần trả:</h4>
            <table class="table table-bordered table-hover text-center mt-3">
                <thead class="table-dark">
                    <tr>
                        <th>Chọn</th>
                        <th>Mã sách</th>
                        <th>Ngày phải trả</th>
                        <th>Tình trạng sách</th>
                        <th>Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                @for (int i = 0; i < Model.dsct.Count; i++)
                {
                    <tr>
                        <form method="post" asp-page-handler="XacNhanTra">
                            <input type="hidden" name="MaDocGia" value="@Model.MaDocGia" />
                         

                        <td class="align-middle">
                            <input type="checkbox" name="SachDuocChon" value="@Model.dsct[i].MaSach" />
                        </td>
                        <td class="align-middle">@Model.dsct[i].MaSach</td>
                        <td class="align-middle">@Model.dsct[i].NgayPhaiTra?.ToString("dd/MM/yyyy")</td>
                        <td class="align-middle">
                            <select name="TinhTrangSach" class="form-select" required>
                                <option value="">.....</option>
                                <option value="Còn mới">Còn mới</option>
                                <option value="Hư hỏng">Hư hỏng</option>
                            </select>
                        </td>
                        <td>
                            <button type="submit" class="btn btn-success"
                                    onclick="return confirm('Bạn có chắc chắn muốn xác nhận trả sách này?');">
                                ✅ Xác nhận trả
                            </button>
                        </td>
                        </form>
                    </tr>
                }
                </tbody>
            </table>

          
                
            
       
    }
    else if (Model.dsct != null)
    {
        <p class="text-muted fst-italic">⚠ Không tìm thấy sách nào đang được mượn bởi độc giả này.</p>
    }
</div>
